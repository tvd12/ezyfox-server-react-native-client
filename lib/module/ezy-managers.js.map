{"version":3,"sources":["ezy-managers.js"],"names":["Const","Handler","EzyLogger","EzyAppManager","constructor","zoneName","appList","appsById","appsByName","getApp","app","length","console","log","addApp","push","id","name","removeApp","appId","filter","item","getAppById","getAppByName","EzyPluginManager","pluginList","pluginsById","pluginsByName","getPlugin","plugin","warn","addPlugin","getPluginById","getPluginByName","EzyPingManager","pingPeriod","lostPingCount","maxLostPingCount","increaseLostPingCount","EzyHandlerManager","client","dataHandlers","newDataHandlers","eventHandlers","newEventHandlers","appDataHandlerss","pluginDataHandlerss","handlers","EzyEventHandlers","addHandler","EzyEventType","CONNECTION_SUCCESS","EzyConnectionSuccessHandler","CONNECTION_FAILURE","EzyConnectionFailureHandler","DISCONNECTION","EzyDisconnectionHandler","EzyDataHandlers","EzyCommand","PONG","EzyPongHandler","HANDSHAKE","EzyHandshakeHandler","LOGIN","EzyLoginSuccessHandler","LOGIN_ERROR","EzyLoginErrorHandler","APP_ACCESS","EzyAppAccessHandler","APP_REQUEST","EzyAppResponseHandler","APP_EXIT","EzyAppExitHandler","PLUGIN_INFO","EzyPluginInfoHandler","PLUGIN_REQUEST","EzyPluginResponseHandler","getDataHandler","cmd","handler","getHandler","getEventHandler","eventType","getAppDataHandlers","appName","answer","EzyAppDataHandlers","getPluginDataHandlers","pluginName","EzyPluginDataHandlers","addDataHandler","dataHandler","addEventHandler","eventHandler"],"mappings":"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","sourcesContent":["import Const from './ezy-constants';\nimport Handler from './ezy-handlers';\nimport EzyLogger from './ezy-logger';\n\nclass EzyAppManager {\n    constructor(zoneName) {\n        this.zoneName = zoneName;\n        this.appList = [];\n        this.appsById = {};\n        this.appsByName = {};\n    }\n\n    getApp() {\n        var app = null;\n        if (this.appList.length > 0) app = this.appList[0];\n        else console.log('has no app in zone: ' + this.zoneName);\n        return app;\n    }\n\n    addApp(app) {\n        this.appList.push(app);\n        this.appsById[app.id] = app;\n        this.appsByName[app.name] = app;\n    }\n\n    removeApp(appId) {\n        var app = this.appsById[appId];\n        if (app) {\n            delete this.appsById[appId];\n            delete this.appsByName[app.name];\n            this.appList = this.appList.filter((item) => item.id !== appId);\n        }\n        return app;\n    }\n\n    getAppById(id) {\n        var app = this.appsById[id];\n        return app;\n    }\n\n    getAppByName(name) {\n        var app = this.appsByName[name];\n        return app;\n    }\n}\n\n//======================================\n\nclass EzyPluginManager {\n    constructor(zoneName) {\n        this.zoneName = zoneName;\n        this.pluginList = [];\n        this.pluginsById = {};\n        this.pluginsByName = {};\n    }\n\n    getPlugin() {\n        var plugin = null;\n        if (this.pluginList.length > 0) plugin = this.pluginList[0];\n        else EzyLogger.warn('has no plugin in zone: ' + this.zoneName);\n        return plugin;\n    }\n\n    addPlugin(plugin) {\n        this.pluginList.push(plugin);\n        this.pluginsById[plugin.id] = plugin;\n        this.pluginsByName[plugin.name] = plugin;\n    }\n\n    getPluginById(id) {\n        var plugin = this.pluginsById[id];\n        return plugin;\n    }\n\n    getPluginByName(name) {\n        var plugin = this.pluginsByName[name];\n        return plugin;\n    }\n}\n\n//======================================\n\nclass EzyPingManager {\n    constructor() {\n        this.pingPeriod = 5000;\n        this.lostPingCount = 0;\n        this.maxLostPingCount = 5;\n    }\n\n    increaseLostPingCount() {\n        return ++this.lostPingCount;\n    }\n}\n\n//===================================================\n\nclass EzyHandlerManager {\n    constructor(client) {\n        this.client = client;\n        this.dataHandlers = this.newDataHandlers();\n        this.eventHandlers = this.newEventHandlers();\n        this.appDataHandlerss = {};\n        this.pluginDataHandlerss = {};\n    }\n\n    newEventHandlers() {\n        var handlers = new Handler.EzyEventHandlers(this.client);\n        handlers.addHandler(\n            Const.EzyEventType.CONNECTION_SUCCESS,\n            new Handler.EzyConnectionSuccessHandler()\n        );\n        handlers.addHandler(\n            Const.EzyEventType.CONNECTION_FAILURE,\n            new Handler.EzyConnectionFailureHandler()\n        );\n        handlers.addHandler(\n            Const.EzyEventType.DISCONNECTION,\n            new Handler.EzyDisconnectionHandler()\n        );\n        return handlers;\n    }\n\n    newDataHandlers() {\n        var handlers = new Handler.EzyDataHandlers(this.client);\n        handlers.addHandler(\n            Const.EzyCommand.PONG,\n            new Handler.EzyPongHandler()\n        );\n        handlers.addHandler(\n            Const.EzyCommand.HANDSHAKE,\n            new Handler.EzyHandshakeHandler()\n        );\n        handlers.addHandler(\n            Const.EzyCommand.LOGIN,\n            new Handler.EzyLoginSuccessHandler()\n        );\n        handlers.addHandler(\n            Const.EzyCommand.LOGIN_ERROR,\n            new Handler.EzyLoginErrorHandler()\n        );\n        handlers.addHandler(\n            Const.EzyCommand.APP_ACCESS,\n            new Handler.EzyAppAccessHandler()\n        );\n        handlers.addHandler(\n            Const.EzyCommand.APP_REQUEST,\n            new Handler.EzyAppResponseHandler()\n        );\n        handlers.addHandler(\n            Const.EzyCommand.APP_EXIT,\n            new Handler.EzyAppExitHandler()\n        );\n        handlers.addHandler(\n            Const.EzyCommand.PLUGIN_INFO,\n            new Handler.EzyPluginInfoHandler()\n        );\n        handlers.addHandler(\n            Const.EzyCommand.PLUGIN_REQUEST,\n            new Handler.EzyPluginResponseHandler()\n        );\n        return handlers;\n    }\n\n    getDataHandler(cmd) {\n        var handler = this.dataHandlers.getHandler(cmd);\n        return handler;\n    }\n\n    getEventHandler(eventType) {\n        var handler = this.eventHandlers.getHandler(eventType);\n        return handler;\n    }\n\n    getAppDataHandlers(appName) {\n        var answer = this.appDataHandlerss[appName];\n        if (!answer) {\n            answer = new Handler.EzyAppDataHandlers();\n            this.appDataHandlerss[appName] = answer;\n        }\n        return answer;\n    }\n\n    getPluginDataHandlers(pluginName) {\n        var answer = this.pluginDataHandlerss[pluginName];\n        if (!answer) {\n            answer = new Handler.EzyPluginDataHandlers();\n            this.pluginDataHandlerss[pluginName] = answer;\n        }\n        return answer;\n    }\n\n    addDataHandler(cmd, dataHandler) {\n        this.dataHandlers.addHandler(cmd, dataHandler);\n    }\n\n    addEventHandler(eventType, eventHandler) {\n        this.eventHandlers.addHandler(eventType, eventHandler);\n    }\n}\n//===================================================\n\nexport default {\n    EzyAppManager,\n    EzyPluginManager,\n    EzyPingManager,\n    EzyHandlerManager,\n};\n"]}