{"version":3,"sources":["ezy-managers.js"],"names":["Const","Handler","EzyAppManager","constructor","zoneName","appList","appsById","appsByName","getApp","app","length","console","log","addApp","push","id","name","removeApp","appId","filter","item","getAppById","getAppByName","EzyPluginManager","pluginList","pluginsById","pluginsByName","getPlugin","plugin","Util","EzyLogger","addPlugin","getPluginById","getPluginByName","EzyPingManager","pingPeriod","lostPingCount","maxLostPingCount","increaseLostPingCount","EzyHandlerManager","client","dataHandlers","newDataHandlers","eventHandlers","newEventHandlers","appDataHandlerss","pluginDataHandlerss","handlers","EzyEventHandlers","addHandler","EzyEventType","CONNECTION_SUCCESS","EzyConnectionSuccessHandler","CONNECTION_FAILURE","EzyConnectionFailureHandler","DISCONNECTION","EzyDisconnectionHandler","EzyDataHandlers","EzyCommand","PONG","EzyPongHandler","HANDSHAKE","EzyHandshakeHandler","LOGIN","EzyLoginSuccessHandler","LOGIN_ERROR","EzyLoginErrorHandler","APP_ACCESS","EzyAppAccessHandler","APP_REQUEST","EzyAppResponseHandler","APP_EXIT","EzyAppExitHandler","PLUGIN_INFO","EzyPluginInfoHandler","PLUGIN_REQUEST","EzyPluginResponseHandler","getDataHandler","cmd","handler","getHandler","getEventHandler","eventType","getAppDataHandlers","appName","answer","EzyAppDataHandlers","getPluginDataHandlers","pluginName","EzyPluginDataHandlers","addDataHandler","dataHandler","addEventHandler","eventHandler"],"mappings":"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","sourcesContent":["import Const from './ezy-constants'\nimport Handler from './ezy-handlers'\n\nclass EzyAppManager {\n\n    constructor(zoneName) {\n        this.zoneName = zoneName;\n        this.appList = [];\n        this.appsById = {};\n        this.appsByName = {};\n    }\n\n    getApp() {\n        var app = null;\n        if(this.appList.length > 0)\n           app = this.appList[0];\n        else\n            console.log('has no app in zone: ' + this.zoneName);\n        return app;\n    }\n\n    addApp(app) {\n        this.appList.push(app);\n        this.appsById[app.id] = app;\n        this.appsByName[app.name] = app;\n    }\n\n    removeApp(appId) {\n        var app = this.appsById[appId];\n        if(app) {\n            delete this.appsById[appId];\n            delete this.appsByName[app.name];\n            this.appList = this.appList.filter(item => item.id != appId);\n        }\n        return app;\n    }\n\n    getAppById(id) {\n        var app = this.appsById[id];\n        return app;\n    }\n\n    getAppByName(name) {\n        var app = this.appsByName[name];\n        return app;\n    }\n}\n\n//======================================\n\nclass EzyPluginManager {\n\n    constructor(zoneName) {\n        this.zoneName = zoneName;\n        this.pluginList = [];\n        this.pluginsById = {};\n        this.pluginsByName = {};\n    }\n\n    getPlugin() {\n        var plugin = null;\n        if(this.pluginList.length > 0)\n           plugin = this.pluginList[0];\n        else\n            Util.EzyLogger.console('has no plugin in zone: ' + this.zoneName);\n        return plugin;\n    }\n\n    addPlugin(plugin) {\n        this.pluginList.push(plugin);\n        this.pluginsById[plugin.id] = plugin;\n        this.pluginsByName[plugin.name] = plugin;\n    }\n\n    getPluginById(id) {\n        var plugin = this.pluginsById[id];\n        return plugin;\n    }\n\n    getPluginByName(name) {\n        var plugin = this.pluginsByName[name];\n        return plugin;\n    }\n}\n\n//======================================\n\nclass EzyPingManager {\n    constructor() {\n        this.pingPeriod = 5000;\n        this.lostPingCount = 0;\n        this.maxLostPingCount = 5;\n    }\n\n    increaseLostPingCount() {\n        return (++ this.lostPingCount);\n    }\n}\n\n//===================================================\n\nclass EzyHandlerManager {\n\n    constructor(client) {\n        this.client = client;\n        this.dataHandlers = this.newDataHandlers();\n        this.eventHandlers = this.newEventHandlers();\n        this.appDataHandlerss = {};\n        this.pluginDataHandlerss = {};\n    }\n\n    newEventHandlers() {\n        var handlers = new Handler.EzyEventHandlers(this.client);\n        handlers.addHandler(Const.EzyEventType.CONNECTION_SUCCESS, new Handler.EzyConnectionSuccessHandler());\n        handlers.addHandler(Const.EzyEventType.CONNECTION_FAILURE, new Handler.EzyConnectionFailureHandler());\n        handlers.addHandler(Const.EzyEventType.DISCONNECTION, new Handler.EzyDisconnectionHandler());\n        return handlers;\n    }\n\n    newDataHandlers() {\n        var handlers = new Handler.EzyDataHandlers(this.client);\n        handlers.addHandler(Const.EzyCommand.PONG, new Handler.EzyPongHandler());\n        handlers.addHandler(Const.EzyCommand.HANDSHAKE, new Handler.EzyHandshakeHandler());\n        handlers.addHandler(Const.EzyCommand.LOGIN, new Handler.EzyLoginSuccessHandler());\n        handlers.addHandler(Const.EzyCommand.LOGIN_ERROR, new Handler.EzyLoginErrorHandler());\n        handlers.addHandler(Const.EzyCommand.APP_ACCESS, new Handler.EzyAppAccessHandler());\n        handlers.addHandler(Const.EzyCommand.APP_REQUEST, new Handler.EzyAppResponseHandler());\n        handlers.addHandler(Const.EzyCommand.APP_EXIT, new Handler.EzyAppExitHandler());\n        handlers.addHandler(Const.EzyCommand.PLUGIN_INFO, new Handler.EzyPluginInfoHandler());\n        handlers.addHandler(Const.EzyCommand.PLUGIN_REQUEST, new Handler.EzyPluginResponseHandler());\n        return handlers;\n    }\n\n    getDataHandler(cmd) {\n        var handler = this.dataHandlers.getHandler(cmd);\n        return handler;\n    }\n\n    getEventHandler(eventType) {\n        var handler = this.eventHandlers.getHandler(eventType);\n        return handler;\n    }\n\n    getAppDataHandlers(appName) {\n        var answer = this.appDataHandlerss[appName];\n        if(!answer) {\n            answer = new Handler.EzyAppDataHandlers();\n            this.appDataHandlerss[appName] = answer;\n        }\n        return answer;\n    }\n\n    getPluginDataHandlers(pluginName) {\n        var answer = this.pluginDataHandlerss[pluginName];\n        if(!answer) {\n            answer = new Handler.EzyPluginDataHandlers();\n            this.pluginDataHandlerss[pluginName] = answer;\n        }\n        return answer;\n    }\n\n    addDataHandler(cmd, dataHandler) {\n       this.dataHandlers.addHandler(cmd, dataHandler);\n    }\n\n    addEventHandler(eventType, eventHandler) {\n        this.eventHandlers.addHandler(eventType, eventHandler);\n    }\n}\n//===================================================\n\nexport default {EzyAppManager, EzyPluginManager, EzyPingManager, EzyHandlerManager}"]}